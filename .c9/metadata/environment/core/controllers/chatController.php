{"filter":false,"title":"chatController.php","tooltip":"/core/controllers/chatController.php","undoManager":{"mark":28,"position":28,"stack":[[{"start":{"row":34,"column":49},"end":{"row":35,"column":0},"action":"insert","lines":["",""],"id":295},{"start":{"row":35,"column":0},"end":{"row":35,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":34,"column":49},"end":{"row":34,"column":71},"action":"insert","lines":["  \"msgId\"  =>$msgId , "],"id":296}],[{"start":{"row":35,"column":16},"end":{"row":35,"column":49},"action":"insert","lines":[" $this->jData['succ'] =  \"done\"; "],"id":297}],[{"start":{"row":35,"column":31},"end":{"row":35,"column":35},"action":"remove","lines":["succ"],"id":298},{"start":{"row":35,"column":31},"end":{"row":35,"column":36},"action":"insert","lines":["msgId"]}],[{"start":{"row":35,"column":43},"end":{"row":35,"column":50},"action":"remove","lines":["done\"; "],"id":299},{"start":{"row":35,"column":41},"end":{"row":35,"column":48},"action":"insert","lines":["done\"; "]}],[{"start":{"row":35,"column":49},"end":{"row":35,"column":50},"action":"remove","lines":["\""],"id":300},{"start":{"row":35,"column":48},"end":{"row":35,"column":49},"action":"remove","lines":[" "]},{"start":{"row":35,"column":47},"end":{"row":35,"column":48},"action":"remove","lines":[" "]},{"start":{"row":35,"column":46},"end":{"row":35,"column":47},"action":"remove","lines":[";"]},{"start":{"row":35,"column":45},"end":{"row":35,"column":46},"action":"remove","lines":["\""]},{"start":{"row":35,"column":44},"end":{"row":35,"column":45},"action":"remove","lines":["e"]}],[{"start":{"row":35,"column":41},"end":{"row":35,"column":44},"action":"remove","lines":["don"],"id":301},{"start":{"row":35,"column":41},"end":{"row":35,"column":47},"action":"insert","lines":["$msgId"]}],[{"start":{"row":35,"column":47},"end":{"row":35,"column":48},"action":"insert","lines":[";"],"id":302}],[{"start":{"row":34,"column":50},"end":{"row":34,"column":71},"action":"remove","lines":[" \"msgId\"  =>$msgId , "],"id":303}],[{"start":{"row":3,"column":0},"end":{"row":4,"column":0},"action":"insert","lines":["use core\\models\\notificationModel;",""],"id":304,"ignore":true},{"start":{"row":26,"column":0},"end":{"row":27,"column":0},"action":"insert","lines":["            $openChat = $data[\"openChat\"];",""]},{"start":{"row":37,"column":16},"end":{"row":37,"column":17},"action":"remove","lines":[" "]},{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"insert","lines":["",""]},{"start":{"row":39,"column":12},"end":{"row":39,"column":14},"action":"remove","lines":["//"]},{"start":{"row":39,"column":12},"end":{"row":41,"column":19},"action":"insert","lines":["    if($openChat == false || $openChat == \"false\")","                {","                   "]},{"start":{"row":42,"column":12},"end":{"row":42,"column":14},"action":"remove","lines":["//"]},{"start":{"row":42,"column":12},"end":{"row":42,"column":19},"action":"insert","lines":["       "]},{"start":{"row":42,"column":61},"end":{"row":42,"column":65},"action":"insert","lines":["Chat"]},{"start":{"row":42,"column":79},"end":{"row":42,"column":90},"action":"remove","lines":["userId ,$to"]},{"start":{"row":42,"column":79},"end":{"row":42,"column":108},"action":"insert","lines":["data[\"fromId\"] ,$data[\"toId\"]"]},{"start":{"row":43,"column":12},"end":{"row":43,"column":14},"action":"remove","lines":["//"]},{"start":{"row":43,"column":12},"end":{"row":43,"column":18},"action":"insert","lines":["      "]},{"start":{"row":44,"column":0},"end":{"row":45,"column":1},"action":"insert","lines":["                }"," "]},{"start":{"row":46,"column":0},"end":{"row":46,"column":2},"action":"insert","lines":["  "]},{"start":{"row":47,"column":18},"end":{"row":47,"column":20},"action":"insert","lines":["  "]},{"start":{"row":48,"column":18},"end":{"row":48,"column":19},"action":"insert","lines":[" "]},{"start":{"row":48,"column":19},"end":{"row":48,"column":20},"action":"insert","lines":[" "]},{"start":{"row":49,"column":0},"end":{"row":49,"column":2},"action":"insert","lines":["  "]},{"start":{"row":50,"column":18},"end":{"row":50,"column":20},"action":"insert","lines":["  "]},{"start":{"row":51,"column":18},"end":{"row":51,"column":19},"action":"insert","lines":[" "]},{"start":{"row":51,"column":19},"end":{"row":51,"column":20},"action":"insert","lines":[" "]},{"start":{"row":52,"column":0},"end":{"row":52,"column":2},"action":"insert","lines":["  "]},{"start":{"row":53,"column":16},"end":{"row":53,"column":18},"action":"remove","lines":["  "]},{"start":{"row":53,"column":18},"end":{"row":58,"column":17},"action":"insert","lines":["","                if($notificationId != null)","                {","                        // add pusher here tommorrow","                        $this->pusher->trigger( $_ENV['CHANNEL'], 'sendMessageNotification',  $Pusherdata);","                }"]}],[{"start":{"row":107,"column":4},"end":{"row":107,"column":7},"action":"remove","lines":["// "],"id":305},{"start":{"row":108,"column":4},"end":{"row":108,"column":7},"action":"remove","lines":["// "]},{"start":{"row":109,"column":4},"end":{"row":109,"column":6},"action":"remove","lines":["//"]},{"start":{"row":110,"column":4},"end":{"row":110,"column":7},"action":"remove","lines":["// "]},{"start":{"row":111,"column":4},"end":{"row":111,"column":7},"action":"remove","lines":["// "]},{"start":{"row":112,"column":4},"end":{"row":112,"column":7},"action":"remove","lines":["// "]},{"start":{"row":113,"column":4},"end":{"row":113,"column":7},"action":"remove","lines":["// "]},{"start":{"row":114,"column":4},"end":{"row":114,"column":7},"action":"remove","lines":["// "]},{"start":{"row":115,"column":4},"end":{"row":115,"column":7},"action":"remove","lines":["// "]},{"start":{"row":117,"column":4},"end":{"row":117,"column":7},"action":"remove","lines":["// "]},{"start":{"row":119,"column":4},"end":{"row":119,"column":7},"action":"remove","lines":["// "]}],[{"start":{"row":120,"column":3},"end":{"row":136,"column":5},"action":"insert","lines":["    public function fetchChatusers()","    {","        // here must return logged user full data","        if($this->request->method() == \"POST\")","        {","           $id = Application::$app->session->userId;","","            $this->jData['loggedUserId'] = $id;","            $users = $this->model->fetchChatUsers($id);","              $this->jData['users'] = $users;","           $this->json(); ","","        }else ","        {","        $this->response->renderView(\"/home\" ,$this->data );","        }","    }"],"id":306}],[{"start":{"row":107,"column":0},"end":{"row":119,"column":5},"action":"remove","lines":["    public function fetchChatUsers()","    {","        $userId = Application::$app->session->userId;","        if($this->request->getMethod() == \"POST\")","        {","            $data = $this->request->getBody();","            $this->jData['users'] = $this->model->fetchChatUsers($userId);","            $this->jData[\"loggedUserId\"] = $userId;","            $this->json();","            ","        }","","    }"],"id":307}],[{"start":{"row":108,"column":23},"end":{"row":108,"column":37},"action":"remove","lines":["fetchChatusers"],"id":308},{"start":{"row":108,"column":23},"end":{"row":108,"column":37},"action":"insert","lines":["fetchChatUsers"]}],[{"start":{"row":108,"column":4},"end":{"row":108,"column":6},"action":"insert","lines":["//"],"id":309},{"start":{"row":109,"column":4},"end":{"row":109,"column":7},"action":"insert","lines":["// "]},{"start":{"row":110,"column":4},"end":{"row":110,"column":7},"action":"insert","lines":["// "]},{"start":{"row":111,"column":4},"end":{"row":111,"column":7},"action":"insert","lines":["// "]},{"start":{"row":112,"column":4},"end":{"row":112,"column":7},"action":"insert","lines":["// "]},{"start":{"row":113,"column":4},"end":{"row":113,"column":6},"action":"insert","lines":["//"]},{"start":{"row":115,"column":4},"end":{"row":115,"column":7},"action":"insert","lines":["// "]},{"start":{"row":116,"column":4},"end":{"row":116,"column":7},"action":"insert","lines":["// "]},{"start":{"row":117,"column":4},"end":{"row":117,"column":7},"action":"insert","lines":["// "]},{"start":{"row":118,"column":4},"end":{"row":118,"column":6},"action":"insert","lines":["//"]},{"start":{"row":120,"column":4},"end":{"row":120,"column":7},"action":"insert","lines":["// "]},{"start":{"row":121,"column":4},"end":{"row":121,"column":7},"action":"insert","lines":["// "]},{"start":{"row":122,"column":4},"end":{"row":122,"column":7},"action":"insert","lines":["// "]},{"start":{"row":123,"column":4},"end":{"row":123,"column":7},"action":"insert","lines":["// "]},{"start":{"row":124,"column":4},"end":{"row":124,"column":7},"action":"insert","lines":["// "]}],[{"start":{"row":19,"column":9},"end":{"row":20,"column":0},"action":"insert","lines":["",""],"id":310},{"start":{"row":20,"column":0},"end":{"row":20,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":20,"column":12},"end":{"row":20,"column":62},"action":"insert","lines":["  \"userId\" => Application::$app->session->userId ,"],"id":311}],[{"start":{"row":20,"column":14},"end":{"row":20,"column":26},"action":"remove","lines":["\"userId\" => "],"id":312},{"start":{"row":20,"column":13},"end":{"row":20,"column":14},"action":"remove","lines":[" "]}],[{"start":{"row":20,"column":13},"end":{"row":20,"column":14},"action":"insert","lines":["#"],"id":313},{"start":{"row":20,"column":14},"end":{"row":20,"column":15},"action":"insert","lines":["م"]},{"start":{"row":20,"column":15},"end":{"row":20,"column":16},"action":"insert","lines":["خ"]},{"start":{"row":20,"column":16},"end":{"row":20,"column":17},"action":"insert","lines":["ل"]},{"start":{"row":20,"column":17},"end":{"row":20,"column":18},"action":"insert","lines":["ل"]}],[{"start":{"row":20,"column":17},"end":{"row":20,"column":18},"action":"remove","lines":["ل"],"id":314},{"start":{"row":20,"column":16},"end":{"row":20,"column":17},"action":"remove","lines":["ل"]},{"start":{"row":20,"column":15},"end":{"row":20,"column":16},"action":"remove","lines":["خ"]},{"start":{"row":20,"column":14},"end":{"row":20,"column":15},"action":"remove","lines":["م"]},{"start":{"row":20,"column":13},"end":{"row":20,"column":14},"action":"remove","lines":["#"]}],[{"start":{"row":20,"column":13},"end":{"row":20,"column":14},"action":"insert","lines":["$"],"id":315},{"start":{"row":20,"column":14},"end":{"row":20,"column":15},"action":"insert","lines":["l"]},{"start":{"row":20,"column":15},"end":{"row":20,"column":16},"action":"insert","lines":["o"]},{"start":{"row":20,"column":16},"end":{"row":20,"column":17},"action":"insert","lines":["g"]},{"start":{"row":20,"column":17},"end":{"row":20,"column":18},"action":"insert","lines":["g"]},{"start":{"row":20,"column":18},"end":{"row":20,"column":19},"action":"insert","lines":["e"]},{"start":{"row":20,"column":19},"end":{"row":20,"column":20},"action":"insert","lines":["d"]}],[{"start":{"row":20,"column":20},"end":{"row":20,"column":21},"action":"insert","lines":["U"],"id":316},{"start":{"row":20,"column":21},"end":{"row":20,"column":22},"action":"insert","lines":["s"]},{"start":{"row":20,"column":22},"end":{"row":20,"column":23},"action":"insert","lines":["e"]},{"start":{"row":20,"column":23},"end":{"row":20,"column":24},"action":"insert","lines":["r"]}],[{"start":{"row":20,"column":24},"end":{"row":20,"column":25},"action":"insert","lines":[" "],"id":317},{"start":{"row":20,"column":25},"end":{"row":20,"column":26},"action":"insert","lines":["="]}],[{"start":{"row":20,"column":26},"end":{"row":20,"column":27},"action":"insert","lines":[" "],"id":318}],[{"start":{"row":20,"column":62},"end":{"row":20,"column":63},"action":"remove","lines":[","],"id":319}],[{"start":{"row":20,"column":62},"end":{"row":20,"column":63},"action":"insert","lines":[";"],"id":320}],[{"start":{"row":20,"column":12},"end":{"row":20,"column":13},"action":"remove","lines":[" "],"id":321}],[{"start":{"row":53,"column":55},"end":{"row":53,"column":56},"action":"insert","lines":[" "],"id":322},{"start":{"row":53,"column":56},"end":{"row":53,"column":57},"action":"insert","lines":[","]}],[{"start":{"row":53,"column":57},"end":{"row":54,"column":0},"action":"insert","lines":["",""],"id":323},{"start":{"row":54,"column":0},"end":{"row":54,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":43,"column":78},"end":{"row":43,"column":93},"action":"remove","lines":["$data[\"fromId\"]"],"id":330},{"start":{"row":43,"column":78},"end":{"row":43,"column":89},"action":"insert","lines":["$loggedUser"]}],[{"start":{"row":54,"column":36},"end":{"row":54,"column":37},"action":"remove","lines":["$"],"id":329},{"start":{"row":54,"column":36},"end":{"row":54,"column":47},"action":"insert","lines":["$loggedUser"]}],[{"start":{"row":54,"column":35},"end":{"row":54,"column":36},"action":"insert","lines":[" "],"id":328},{"start":{"row":54,"column":36},"end":{"row":54,"column":37},"action":"insert","lines":["$"]}],[{"start":{"row":54,"column":32},"end":{"row":54,"column":33},"action":"insert","lines":[" "],"id":327},{"start":{"row":54,"column":33},"end":{"row":54,"column":34},"action":"insert","lines":["="]},{"start":{"row":54,"column":34},"end":{"row":54,"column":35},"action":"insert","lines":[">"]}],[{"start":{"row":54,"column":21},"end":{"row":54,"column":25},"action":"remove","lines":["logg"],"id":326},{"start":{"row":54,"column":21},"end":{"row":54,"column":31},"action":"insert","lines":["loggedUser"]}],[{"start":{"row":54,"column":21},"end":{"row":54,"column":22},"action":"insert","lines":["l"],"id":325},{"start":{"row":54,"column":22},"end":{"row":54,"column":23},"action":"insert","lines":["o"]},{"start":{"row":54,"column":23},"end":{"row":54,"column":24},"action":"insert","lines":["g"]},{"start":{"row":54,"column":24},"end":{"row":54,"column":25},"action":"insert","lines":["g"]}],[{"start":{"row":54,"column":20},"end":{"row":54,"column":22},"action":"insert","lines":["\"\""],"id":324}]]},"ace":{"folds":[],"scrolltop":614,"scrollleft":0,"selection":{"start":{"row":52,"column":40},"end":{"row":52,"column":40},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":93,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1672483830256,"hash":"74ec03a5f1b733f1fb2fb6092137d4fdc7fc4005"}